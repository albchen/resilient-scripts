
# list of known malware hashes - SHA-256
black_list = {
    'subseven': '322555292bb3fb081c764fd99069c7d9274fb001d2eae70891bb4ce1230018ec',
    'wannacry': '2760e23f10c86e21c356f13d60d3a6f1d9f5ae984395de738825c2282addc74b',
    'nukesped': '4d6ace687287bfa81385f114fc67ef489fc6d532ac390a25002dbf9b94e21fb9',
    'androrat': 'd9c6d0f8879fd6706b8b43d5456529159663d8aa942d87b54dab8776dcd4a7d4'
}

# message to update the parent incident
warning_message = '<span style="color:#e3a21a;">Warning!</span><br>Artifact ' + \
    str(artifact.id) + \
    ' hash matches known malware: <span style="color:#b91d47;">{}</span>'
# the incident that owns the artifact
parent_incident = artifact.getParentObject()

# Try match the hash
for malware, _hash in black_list.items():
    if _hash == artifact.value:
        parent_incident.description = warning_message.format(malware)
        parent_incident.severity_code = 'High'
        artifact.description = '{} malware'.format(malware)
